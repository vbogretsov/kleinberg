# Глава I

## Опечатки

* стр. 50, задача 4. $s$ предпочитает $h$ студенту $h^{'}$ $->$ $s^{'}$ предпочитает $h$ больнице $h^{'}$
* cnh& 52 $m$ женщине $m^{'}$ $->$ $m$ мущине $m^{'}$

## 1. Устойчивые паросочетания

### Алгоритм Гейла-Шепли

В начальном состоянии все $m \in M$ and $w \in W$ свободны \
Пока $\exists m \in M$ такой, что $m$ не успел сделать предложение каждой $w \in W$ \
&nbsp;&nbsp; Выбрать такого $m$ \
&nbsp;&nbsp; Выбрать $w \in W$ тукую, что её оценка в списке приоритетов $m$ максимальна среди тех $w \in W$, которым $m$ ещё не успел сделать предложение \
&nbsp;&nbsp; Сделать предложение выбранной $w$ \
&nbsp;&nbsp; Если $w$ свободна \
&nbsp;&nbsp;&nbsp;&nbsp; пара $(m, w)$ вступает в состояние помолвки \
&nbsp;&nbsp; Иначе $w$ в настоящее время помолвлена с $m'$ \
&nbsp;&nbsp;&nbsp;&nbsp; Если для $w$ $m'$ предпочтительнее $m$ \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $m$ остаётся свободным \
&nbsp;&nbsp;&nbsp;&nbsp; Иначе \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; пара $(m, w)$ вступает в состояние помолвки \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $m'$ становится свободным \
Вернуть множество $S$ помолвленных пар

### Утверждение 1.

Алгоритм завершается после выполнения максимум $n^2$ итераций цикла $Пока$.

### Утверждение 2.

Если на какой-то итерации существует свободный $m$, то существует $w$, которой $m$ ещё не делал предложение.

### Утверждение 3.

Множество $S$, возвращаемое алгоритмом, является *идеальным паросочетанием*.

### Утверждение 4.

Множество $S$, возврашаемое алгоритмом, является *устойчивым паросочетанием*.

### Определение 1.

$w \in W$ является *действительным партнёром* для $m \in M$, если существует *устойчивое паросочетание* $S$ такое, что $(m, w) \in S$.

### Определение 2.

$w \in W$ является *лучшим действительным партнёром* для $m \in M$, если $w$ является для $m$ *действительным партёром* и никакая $w' \in W$, которой $m$ даёт более высокую оценку не является для него *действительным партнёром*. Далеее обозначается $w = best(m)$.

### Утверждение 5.

Каждое выполнение алгоритма приводит к множеству $S^*=\{(m, best(m))| m \in M \}$.

#### Доказательство.

Рассмотреть *первое* отвержение $m$ его действительным партнёром $w$ и альтернативное паросочетание, которое окажется неустойчивым.

### Утверждение 6.

В *устойчивом паросочетании* $S^*$ каждая женщиная оказывается со своим худшим *действительным партнёром*.

## Задачи

### 1.

Рассмотреть следующую конфигурацию: $list(m_1) = [w_1, w_2]$, $list(m_2) = [w_2, w_1]$, $list(w_1) = [m_2, m_1]$, $list(w_2) = [m_1, m_2]$

### 2.

Если $S^{'} \neq S$, $(m, w^{'}) \in S^{'}$ и $(m^{'}, w) \in S^{'}$, то $S^{'}$ не может быть устойчивым паросочетанием, так как пара $(m, w)$ нарушает устойчивость.

### 3.

Рассмотреть следующую конфигурацию: $tv(A) = [1, 3, 5]$, $tv(B) = [2, 4, 6]$

### 4.

Пусть $H$ - множество больниц, $S$ - множество студентов. Необходимо найти множество $C={(s, h)| s \in S, h \in H}$ контрактов.

**Алгоритм**

В начальном состоянии все $h \in H$ and $s \in S$ свободны \
Пока $\exists h \in H$ такую, что $h$ не успел сделать предложение каждому $s \in S$ \
&nbsp;&nbsp; Выбрать такую $h$ \
&nbsp;&nbsp; Выбрать $s \in S$ такого, что его оценка в списке приоритетов $h$ максимальна среди тех $s \in S$, которым $h$ ещё не делала предложение \
&nbsp;&nbsp; Сделать предложение выбранному $s$ \
&nbsp;&nbsp; Если $s$ свободен \
&nbsp;&nbsp;&nbsp;&nbsp; пара $(h, s)$ намеревается подписать контракт \
&nbsp;&nbsp; Иначе $s$ в настоящее время планирует работать в $h'$ \
&nbsp;&nbsp;&nbsp;&nbsp; Если для $s$ $h'$ предпочтительнее $h$ \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $h$ остаётся без студента \
&nbsp;&nbsp;&nbsp;&nbsp; Иначе \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; пара $(h, s)$ намеревается подписать контракт \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $h'$ остаётся без студента \
Вернуть множество $C$ контрактов

#### Утверждение 1.

Алгоритм завершается не более, чем за $mn$ итераций.

#### Утверждение 2.

В кадждую больницу направлен студент.

#### Утверждение 3.

Пусть $(h, s) \in C$, $s^{'}$ свободен, тогда $s$ предпочтительнее $s^{'}$ для h.

**Доказательство.**

Пусть $s^{'}$ предпочтительнее $s$ для $h$, тогда $s^{'}$ стоит в списке
приоритетов $h$ выше, чем $s$. Если $s^{'}$ свободен, то ему ни одна больница
не делала предложение, но для того, чтобы образовалась пара $(h, s)$ $h$ должна
была сделать предложение $s^{'}$ до $s$ исходя из приоритета. Противоречие.

#### Утверждение 4.

Для резултата алгоритма $C$ не может выполняться следующее условие:
$(h, s) \in C$, $(h^{'}, s^{'}) \in C$, для $h$ $s^{'}$ предпочтительнее $s$,
для $s^{'}$ $h$ предпочтительнее $h^{'}$.

**Доказательство.**

Предположим условие выполняется. Так как $s^{'}$ предпочтительнее $s$ для $h$,
$h$ должна была сделать предложение $s^{'}$ раньше, чем $s$. Если $s^{'}$
отклонил предложение $h$, например в пользу $h^{''}$, то $h^{''}$
предпочтительнее $h$ для $s^{'}$, то $h^{''}$ предпочтительнее и $h^{'}$ для
$s^{'}$. Следовательно, пара $(h, s)$ не может образоваться в результате
выполнения алгоритма. Противоречие.

### 5.

Модификация алгоритма Гейла-Шепли, когда $w$ отвергает $m^{'}$ в пользу
существующей помолвки с $m$ если для неё $m^{'}$ оценивается не выше, чем $m$,
не допускает *сильной неустойчивости*.

Существуют конфигурации, когда слабая неустойчивость будет существовать в любом
паросочетании.

**Пример**

* $m_1$: $w_1 >= w_2$
* $m_2$: $w_1 >= w_2$
* $w_1$: $m_1 == m_2$
* $w_2$: $m_1 == m_2$

### 6.

Алгоритм Гейла-Шепли, где корабли делают предложения, список предпочтений
коробля - расписание портов в хронологическом порядке, списко предпочтений длля
портов - расписание прибытия кораблей в обратном порядке.


