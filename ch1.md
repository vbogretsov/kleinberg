# Глава I

## 1. Устойчивые паросочетания

### Алгоритм Гейла-Шепли

В начальном состоянии все $m \in M$ and $w \in W$ свободны \
Пока $\exists m \in M$ такой, что $m$ не успел сделать предложение каждой $w \in W$ \
&nbsp;&nbsp; Выбрать такого $m$ \
&nbsp;&nbsp; Выбрать $w \in W$ тукую, что её оценка в списке приоритетов $m$ максимальна среди тех $w \in W$, которым $m$ ещё не успел сделать предложение \
&nbsp;&nbsp; Сделать предложение выбранной $w$ \
&nbsp;&nbsp; Если $w$ свободна \
&nbsp;&nbsp;&nbsp;&nbsp; пара $(m, w)$ вступает в состояние помолвки \
&nbsp;&nbsp; Иначе $w$ в настоящее время помолвлена с $m'$ \
&nbsp;&nbsp;&nbsp;&nbsp; Если для $w$ $m'$ предпочтительнее $m$ \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $m$ остаётся свободным \
&nbsp;&nbsp;&nbsp;&nbsp; Иначе \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; пара $(m, w)$ вступает в состояние помолвки \
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $m'$ становится свободным \
Вернуть множество $S$ помолвленных пар

### Утверждение 1.

Алгоритм завершается после выполнения максимум $n^2$ итераций цикла $Пока$.

### Утверждение 2.

Если на какой-то итерации существует свободный $m$, то существует $w$, которой $m$ ещё не делал предложение.

### Утверждение 3.

Множество $S$, возвращаемое алгоритмом, является *идеальным паросочетанием*.

### Утверждение 4.

Множество $S$, возврашаемое алгоритмом, является *устойчивым паросочетанием*.

### Определение 1.

$w \in W$ является *действительным партнёром* для $m \in M$, если существует *устойчивое паросочетание* $S$ такое, что $(m, w) \in S$.

### Определение 2.

$w \in W$ является *лучшим действительным партнёром* для $m \in M$, если $w$ является для $m$ *действительным партёром* и никакая $w' \in W$, которой $m$ даёт более высокую оценку не является для него *действительным партнёром*. Далеее обозначается $w = best(m)$.

### Утверждение 5.

Каждое выполнение алгоритма приводит к множеству $S^*=\{(m, best(m))| m \in M \}$.

### Утверждение 6.

В *устойчивом паросочетании* $S^*$ каждая женщиная оказывается со своим худшим действительным партнёром.
